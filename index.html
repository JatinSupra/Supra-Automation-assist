<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supra Automation Assist</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #131722 0%, #1D2A3A 100%);
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
            position: relative;
        }

         .floating-letters {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .letter {
            position: absolute;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: rgba(207, 45, 75, 0.496);
            animation: float-letter linear infinite;
            user-select: none;
        }

        .binary {
            font-size: 18px;
            color: rgba(207, 45, 75, 0.496);
        }

        .code-char {
            font-size: 18px;
            color: rgba(29, 42, 58, 0.8);
        }

        .supra-char {
            font-size: 14px;
            color: rgba(221, 20, 56, 0.2);
            font-weight: 700;
        }

        @keyframes float-letter {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 1;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

         .particle-system {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #DD1438;
            border-radius: 50%;
            opacity: 0.6;
            animation: particle-float linear infinite;
        }

        @keyframes particle-float {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-50px) translateX(100px);
                opacity: 0;
            }
        }

         .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.02;
            background-image: 
                linear-gradient(rgba(221, 20, 56, 0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(221, 20, 56, 0.3) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: -1;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .logo {
            font-size: 1.7rem;
            font-weight: 500;
            background: linear-gradient(135deg, #DD1438 0%, #ff4567 50%, #DD1438 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #DD1438, transparent);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 10px #DD1438; }
            to { box-shadow: 0 0 20px #DD1438, 0 0 30px #DD1438; }
        }

        .subtitle {
            font-size: 1.2rem;
            color: #9EABB5;
            font-weight: 400;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.2;
        }

         .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(29, 42, 58, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(53, 63, 74, 0.3);
            border-radius: 22px;
            padding: 1.3rem;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(221, 20, 56, 0.5), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            border-color: rgba(221, 20, 56, 0.4);
            box-shadow: 
                0 25px 50px rgba(19, 23, 34, 0.4),
                0 0 40px rgba(221, 20, 56, 0.15);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.65rem;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #00ff88;
            box-shadow: 0 0 12px rgba(0, 255, 136, 0.6);
            animation: pulse-green 2s ease-in-out infinite;
        }

        @keyframes pulse-green {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .countdown-icon {
            background: #DD1438;
            box-shadow: 0 0 12px rgba(221, 20, 56, 0.6);
            animation: pulse-red 1s ease-in-out infinite;
        }

        @keyframes pulse-red {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .stat-title {
            font-size: 1rem;
            font-weight: 600;
            color: #9EABB5;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .stat-value {
            font-size: 1.6rem;
            font-weight: 800;
            color: #ffffff;
            font-family: 'JetBrains Mono', monospace;
            line-height: 1.1;
            margin-top: 0.25rem;
        }

        .countdown-value {
            background: linear-gradient(135deg, #DD1438, #ff4567);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

         .values-section {
            background: rgba(29, 42, 58, 0.3);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(53, 63, 74, 0.4);
            border-radius: 24px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        .values-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(221, 20, 56, 0.4), transparent);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .values-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 1.5rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .values-title::before {
            font-size: 1.5rem;
        }

        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .value-item {
            background: rgba(53, 63, 74, 0.3);
            border: 1px solid rgba(106, 115, 124, 0.2);
            border-radius: 16px;
            padding: 1.4rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .value-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(221, 20, 56, 0.05), transparent);
            transition: left 0.5s ease;
        }

        .value-item:hover::before {
            left: 100%;
        }

        .value-item:hover {
            border-color: rgba(221, 20, 56, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 15px 35px rgba(19, 23, 34, 0.3);
        }

        .value-label {
            font-size: 0.9rem;
            color: #9EABB5;
            margin-bottom: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .value-content {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            color: #ffffff;
            background: rgba(53, 63, 74, 0.4);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid rgba(106, 115, 124, 0.3);
            word-break: break-all;
            line-height: 1.4;
            min-height: 50px;
            display: flex;
            align-items: center;
        }

        .cli-content {
            font-size: 0.85rem;
            white-space: pre-wrap;
            max-height: 120px;
            overflow-y: auto;
            min-height: 100px;
            align-items: flex-start;
            padding-top: 0.75rem;
        }

        .copy-btn {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: linear-gradient(135deg, #DD1438, #c41030);
            border: none;
            color: white;
            padding: 0.2rem 1.4rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(221, 20, 56, 0.3);
        }

        .copy-btn:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 8px 25px rgba(221, 20, 56, 0.5);
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        .copy-btn.success {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
        }

        .loading-spinner {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(221, 20, 56, 0.2);
            border-radius: 50%;
            border-top-color: #DD1438;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Resources Section */
        .resources-section {
            background: rgba(29, 42, 58, 0.25);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(53, 63, 74, 0.3);
            border-radius: 24px;
            padding: 2rem;
            margin-top: 2rem;
            position: relative;
            overflow: hidden;
        }

        .resources-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(221, 20, 56, 0.3), transparent);
            animation: shimmer 4s ease-in-out infinite;
        }

        .resources-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 1.5rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .resources-title::before {
            font-size: 1.5rem;
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .resource-card {
            background: rgba(53, 63, 74, 0.3);
            border: 1px solid rgba(106, 115, 124, 0.2);
            border-radius: 16px;
            padding: 1.25rem;
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .resource-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(221, 20, 56, 0.05), transparent);
            transition: left 0.5s ease;
        }

        .resource-card:hover::before {
            left: 100%;
        }

        .resource-card:hover {
            border-color: rgba(221, 20, 56, 0.4);
            transform: translateY(-4px);
            box-shadow: 0 15px 35px rgba(19, 23, 34, 0.3);
        }

        .resource-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(29, 42, 58, 0.5);
            border-radius: 12px;
            border: 1px solid rgba(221, 20, 56, 0.2);
            flex-shrink: 0;
        }

        .resource-info {
            flex: 1;
        }

        .resource-name {
            font-size: 1rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.25rem;
        }

        .resource-desc {
            font-size: 0.85rem;
            color: #9EABB5;
            font-weight: 400;
        }

        .status-bar {
            position: fixed;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(19, 23, 34, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(53, 63, 74, 0.4);
            border-radius: 50px;
            padding: 0.75rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.8rem;
            color: #9EABB5;
            z-index: 100;
            box-shadow: 0 5px 20px rgba(19, 23, 34, 0.5);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ff88;
            animation: pulse-green 2s ease-in-out infinite;
        }

         @media (max-width: 1200px) {
            .stats-row {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .values-grid {
                grid-template-columns: 1fr;
            }

            .resources-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .logo {
                font-size: 2.8rem;
            }
            
            .stat-card {
                padding: 2rem;
            }
            
            .values-section {
                padding: 2rem;
            }
            
            .status-bar {
                bottom: 1rem;
                left: 1rem;
                right: 1rem;
                transform: none;
                padding: 1rem 1.5rem;
            }

            .resource-card {
                padding: 1rem;
            }
            
            .resource-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
        }

         .cli-content::-webkit-scrollbar {
            width: 6px;
        }

        .cli-content::-webkit-scrollbar-track {
            background: rgba(53, 63, 74, 0.3);
            border-radius: 3px;
        }

        .cli-content::-webkit-scrollbar-thumb {
            background: rgba(221, 20, 56, 0.5);
            border-radius: 3px;
        }

        .cli-content::-webkit-scrollbar-thumb:hover {
            background: rgba(221, 20, 56, 0.7);
        }

        /* Automation Registration Wizard */
        .automation-section {
            background: rgba(29, 42, 58, 0.25);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(53, 63, 74, 0.3);
            border-radius: 24px;
            padding: 2rem;
            margin-top: 2rem;
            position: relative;
            overflow: hidden;
        }
        .automation-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(221, 20, 56, 0.4), transparent);
            animation: shimmer 3s ease-in-out infinite;
        }
        .automation-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 0.5rem;
            text-align: center;
        }
        .automation-subtitle {
            color: #9EABB5;
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1rem;
        }
        .wizard-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .wizard-step {
            background: rgba(53, 63, 74, 0.3);
            border: 1px solid rgba(106, 115, 124, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .wizard-step.disabled {
            opacity: 0.5;
            pointer-events: none;
        }
        .wizard-step.active {
            border-color: rgba(221, 20, 56, 0.4);
            box-shadow: 0 5px 20px rgba(221, 20, 56, 0.1);
        }
        .step-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #DD1438, #c41030);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 1.1rem;
            flex-shrink: 0;
        }
        .step-info {
            flex: 1;
        }
        .step-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.25rem;
        }
        .step-desc {
            font-size: 0.9rem;
            color: #9EABB5;
        }
        .step-content {
            padding-left: 3rem;
        }
        /* Buttons */
        .connect-btn, .scan-btn, .deploy-btn {
            background: linear-gradient(135deg, #DD1438, #c41030);
            border: none;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 700;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        .connect-btn:hover, .scan-btn:hover, .deploy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(221, 20, 56, 0.4);
        }
        .btn-icon {
            font-size: 1.2rem;
        }
        /* Input Group */
        .input-group {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        .wizard-input {
            flex: 1;
            background: rgba(53, 63, 74, 0.4);
            border: 1px solid rgba(106, 115, 124, 0.3);
            border-radius: 8px;
            padding: 0.75rem;
            color: #ffffff;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }
        .wizard-input:focus {
            outline: none;
            border-color: rgba(221, 20, 56, 0.5);
            box-shadow: 0 0 0 2px rgba(221, 20, 56, 0.1);
        }
        /* Loading State */
        .loading-state {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #9EABB5;
            margin-top: 1rem;
        }
        /* Wallet Status */
        .wallet-status {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 8px;
        }
        .status-connected {
            color: #00ff88;
            font-weight: 600;
        }
        /* Modules and Functions Grid */
        .modules-grid, .functions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        .module-card, .function-card {
            background: rgba(29, 42, 58, 0.5);
            border: 1px solid rgba(106, 115, 124, 0.2);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .module-card:hover, .function-card:hover {
            border-color: rgba(221, 20, 56, 0.4);
            transform: translateY(-2px);
        }
        .module-card.selected, .function-card.selected {
            border-color: rgba(221, 20, 56, 0.6);
            background: rgba(221, 20, 56, 0.1);
        }
        .module-name, .function-name {
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }
        .module-desc, .function-desc {
            font-size: 0.85rem;
            color: #9EABB5;
        }
        /* Parameters */
        .params-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        .params-section h4 {
            color: #ffffff;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        .param-row {
            margin-bottom: 1rem;
        }
        .param-row label {
            display: block;
            color: #9EABB5;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
        }
        .param-input {
            width: 100%;
            background: rgba(53, 63, 74, 0.4);
            border: 1px solid rgba(106, 115, 124, 0.3);
            border-radius: 8px;
            padding: 0.75rem;
            color: #ffffff;
            font-size: 0.9rem;
        }
        .param-input.readonly {
            background: rgba(53, 63, 74, 0.2);
            cursor: not-allowed;
        }
        .param-row small {
            color: #9EABB5;
            font-size: 0.8rem;
            margin-top: 0.25rem;
            display: block;
        }
        /* Deployment */
        .deployment-preview {
            margin-bottom: 2rem;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .summary-item {
            background: rgba(53, 63, 74, 0.3);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(106, 115, 124, 0.2);
        }
        .summary-label {
            color: #9EABB5;
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        .summary-value {
            color: #ffffff;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }
        .deploy-status {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
        }
        .deploy-status.success {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: #00ff88;
        }
        .deploy-status.error {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            color: #ff6b6b;
        }
        /* Notifications */
        .notification-content {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .notification-icon {
            font-size: 1.2rem;
        }
        
        .notification-message {
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        /* Responsive */
        @media (max-width: 768px) {
            .params-container {
                grid-template-columns: 1fr;
            }
            
            .step-content {
                padding-left: 0;
            }
            
            .input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .modules-grid, .functions-grid {
                grid-template-columns: 1fr;
            }
        }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<link rel="icon" href="assets/logo.png" type="image/png">
<body>
     <div class="particle-system"></div>
    <div class="floating-letters"></div>
    <div class="grid-overlay"></div>
    
    <div class="container">
        <div class="header">
            <h1 class="logo">Real-time Supra Automation Parameters for faster Deployment</h1>
        </div>

         <div class="stats-row">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon"></div>
                    <div class="stat-title">Network Status</div>
                </div>
                <div class="stat-value" id="networkStatus">
                    <div class="loading-spinner"></div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon countdown-icon"></div>
                    <div class="stat-title">Next Epoch In</div>
                </div>
                <div class="stat-value countdown-value" id="timeToNext">
                    <div class="loading-spinner"></div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon"></div>
                    <div class="stat-title">Automation Fee</div>
                </div>
                <div class="stat-value" id="estimatedFee">
                    <div class="loading-spinner"></div>
                </div>
            </div>
        </div>

         <div class="values-section">
            <h3 class="values-title">Ready-to-Use Values</h3>
            
            <div class="values-grid">
                <div class="value-item">
                    <div class="value-info">
                        <div class="value-label">--task-expiry-time-secs</div>
                        <div class="value-content" id="expiryTimeValue">Calculating...</div>
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('expiryTimeValue', this)">Copy</button>
                </div>

                <div class="value-item">
                    <div class="value-info">
                        <div class="value-label">--task-automation-fee-cap</div>
                        <div class="value-content" id="feeCapValue">Calculating...</div>
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('feeCapValue', this)">Copy</button>
                </div>

                <div class="value-item">
                    <div class="value-info">
                        <div class="value-label">Complete CLI Command</div>
                        <div class="value-content cli-content" id="cliTemplate">Generating...</div>
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('cliTemplate', this)">Copy</button>
                </div>
            </div>
        </div>

        <!-- Resources Section -->
        <div class="resources-section">
            <h3 class="resources-title">Automation Dev Resources</h3>
            
            <div class="resources-grid">
                <a href="https://docs.supra.com/network/move/getting-started/supra-cli-with-docker" target="_blank" class="resource-card">
                    <div class="resource-icon">🛠️</div>
                    <div class="resource-info">
                        <div class="resource-name">Install Supra CLI</div>
                        <div class="resource-desc">Get the Supra Docker CLI</div>
                    </div>
                </a>

                <a href="https://docs.supra.com/automation" target="_blank" class="resource-card">
                    <div class="resource-icon">📚</div>
                    <div class="resource-info">
                        <div class="resource-name">Automation Docs</div>
                        <div class="resource-desc">Complete Supra Automation Documentation and Guides</div>
                    </div>
                </a>

                <a href="https://docs.supra.com/network/move/network-information" target="_blank" class="resource-card">
                    <div class="resource-icon">🌐</div>
                    <div class="resource-info">
                        <div class="resource-name">Network Details</div>
                        <div class="resource-desc">RPC endpoints & configs</div>
                    </div>
                </a>

                <a href="https://discord.gg/supralabs" target="_blank" class="resource-card">
                    <div class="resource-icon">💬</div>
                    <div class="resource-info">
                        <div class="resource-name">Dev Support</div>
                        <div class="resource-desc">Join our Discord</div>
                    </div>
                </a>
            </div>
        </div>
    </div>

        <!-- Automation Registration Wizard -->
        <div class="automation-section">
            <h3 class="automation-title">🤖 Automation Registry CLI Command Generator</h3>
            <p class="automation-subtitle">Connect wallet → Select module → Generate CLI command</p>
            
            <div class="wizard-container">
                <!-- Step 1: Connect Wallet -->
                <div class="wizard-step" id="step-1">
                    <div class="step-header">
                        <div class="step-number">1</div>
                        <div class="step-info">
                            <div class="step-title">Connect Wallet</div>
                            <div class="step-desc">Connect your Starkey wallet to scan for modules</div>
                        </div>
                    </div>
                    <div class="step-content">
                        <button class="connect-btn" id="connectWallet">
                            <div class="btn-icon">🗝️</div>
                            <div class="btn-text">Connect Starkey Wallet</div>
                        </button>
                        <div class="wallet-status" id="walletStatus" style="display: none;">
                            <div class="status-connected">✅ Connected: <span id="walletAddress"></span></div>
                        </div>
                        <div class="loading-state" id="autoScanStatus" style="display: none;">
                            <div class="loading-spinner"></div>
                            <span>Scanning for modules...</span>
                        </div>
                    </div>
                </div>
                <!-- Step 2: Select Module -->
                <div class="wizard-step disabled" id="step-2">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div class="step-info">
                            <div class="step-title">Select Module</div>
                            <div class="step-desc">Choose a module from your wallet to explore its functions</div>
                        </div>
                    </div>
                    <div class="step-content">
                        <div class="modules-grid" id="modulesList">
                            <!-- Modules will be populated here -->
                        </div>
                        <div class="loading-state" id="abiLoading" style="display: none;">
                            <div class="loading-spinner"></div>
                            <span>Loading module functions...</span>
                        </div>
                    </div>
                </div>
                <!-- Step 3: Select Function -->
                <div class="wizard-step disabled" id="step-3">
                    <div class="step-header">
                        <div class="step-number">3</div>
                        <div class="step-info">
                            <div class="step-title">Select Function</div>
                            <div class="step-desc">Pick the entry function to automate</div>
                        </div>
                    </div>
                    <div class="step-content">
                        <div class="functions-grid" id="functionsList">
                            <!-- Functions will be populated here -->
                        </div>
                    </div>
                </div>
                <!-- Step 4: Fill Parameters -->
                <div class="wizard-step disabled" id="step-4">
                    <div class="step-header">
                        <div class="step-number">4</div>
                        <div class="step-info">
                            <div class="step-title">Configure Parameters</div>
                            <div class="step-desc">Set function arguments and automation settings</div>
                        </div>
                    </div>
                    <div class="step-content">
                        <div class="params-container">
                            <div class="params-section">
                                <h4>Function Parameters</h4>
                                <div id="functionParams">
                                    <!-- Dynamic parameter inputs will be generated here -->
                                </div>
                            </div>
                            <div class="params-section">
                                <h4>Automation Settings</h4>
                                <div class="automation-params">
                                    <div class="param-row">
                                        <label>Max Gas Amount</label>
                                        <input type="number" id="maxGasAmount" value="50000" class="param-input">
                                    </div>
                                    <div class="param-row">
                                        <label>Gas Price Cap</label>
                                        <input type="number" id="gasPriceCap" value="200" class="param-input">
                                    </div>
                                    <div class="param-row">
                                        <label>Expiry Time</label>
                                        <input type="text" id="expiryTimeAuto" readonly class="param-input readonly">
                                        <small>Auto-calculated from network data</small>
                                    </div>
                                    <div class="param-row">
                                        <label>Automation Fee Cap</label>
                                        <input type="text" id="automationFeeAuto" readonly class="param-input readonly">
                                        <small>Auto-calculated from network data</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Step 5: Generate CLI Command -->
                <div class="wizard-step disabled" id="step-5">
                    <div class="step-header">
                        <div class="step-number">5</div>
                        <div class="step-info">
                            <div class="step-title">Generate CLI Command</div>
                            <div class="step-desc">Get your ready-to-use automation deployment command</div>
                        </div>
                    </div>
                    <div class="step-content">
                        <div class="deployment-preview">
                            <h4>Deployment Summary</h4>
                            <div class="summary-grid" id="deploymentSummary">
                                <!-- Summary will be populated here -->
                            </div>
                        </div>
                        <div class="deploy-actions">
                            <button class="deploy-btn" id="generateCommand">
                                <div class="btn-icon">📋</div>
                                <div class="btn-text">Generate CLI Command</div>
                            </button>
                        </div>
                        <div class="deploy-status" id="deployStatus" style="display: none;">
                            <!-- Deployment status will be shown here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="status-bar">
        <div class="status-dot"></div>
        <span>Updates every 5 seconds</span>
        <span>•</span>
        <span>Built for <strong>Supra</strong> AutoFi</span>
        <span>•</span>
        <a href="https://docs.supra.com" style="color: #DD1438; text-decoration: none;">Docs</a>
    </div>

    <script>
        let updateInterval;
        let countdownInterval;
        let epochData = {};
        let nextEpochTime = null;

         function createFloatingLetters() {
            const container = document.querySelector('.floating-letters');
            const characters = [
                // Binary
                '0', '1', '0', '1', '1', '0', '1', '0',
                // SUPRA letters
                'S', 'U', 'P', 'R', 'A', 'S', 'U', 'P', 'R', 'A',
                // Code characters
                '{', '}', '(', ')', ';', ':', '=', '+', '-', '*',
                // Tech terms
                'fn', 'let', 'mut', 'pub', 'use', 'mod'
            ];

            function createLetter() {
                const letter = document.createElement('div');
                letter.className = 'letter';
                
                const char = characters[Math.floor(Math.random() * characters.length)];
                letter.textContent = char;
                
                 if (char === '0' || char === '1') {
                    letter.classList.add('binary');
                } else if ('SUPRA'.includes(char)) {
                    letter.classList.add('supra-char');
                } else {
                    letter.classList.add('code-char');
                }
                
                 letter.style.left = Math.random() * 100 + '%';
                letter.style.animationDuration = (Math.random() * 15 + 10) + 's';
                letter.style.animationDelay = Math.random() * 5 + 's';
                
                container.appendChild(letter);
                
                 setTimeout(() => {
                    if (letter.parentNode) {
                        letter.parentNode.removeChild(letter);
                    }
                }, 25000);
            }

             setInterval(createLetter, 200);
            
             for (let i = 0; i < 20; i++) {
                setTimeout(createLetter, i * 100);
            }
        }

         function createParticleSystem() {
            const container = document.querySelector('.particle-system');
            
            function createParticle() {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (Math.random() * 8 + 6) + 's';
                particle.style.animationDelay = Math.random() * 3 + 's';
                
                container.appendChild(particle);
                
                 setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 14000);
            }

             setInterval(createParticle, 150);
            
             for (let i = 0; i < 30; i++) {
                setTimeout(createParticle, i * 50);
            }
        }

        // Fetch epoch configuration data
        async function fetchEpochData() {
            try {
                const response = await fetch('https://rpc-testnet.supra.com/rpc/v2/accounts/1/resources/0x1%3A%3Areconfiguration%3A%3AConfiguration');
                const data = await response.json();
                
                if (data.data) {
                    epochData.lastReconfigurationTime = parseInt(data.data.last_reconfiguration_time);
                    epochData.epochInterval = 7200; // 7200 seconds = 2 hours
                    epochData.buffer = 300; // 5 minutes buffer
                    
                    // Calculate next epoch time properly
                    const lastReconfigSecs = Math.floor(epochData.lastReconfigurationTime / 1000000);
                    nextEpochTime = lastReconfigSecs + epochData.epochInterval;
                    
                    document.getElementById('networkStatus').textContent = 'Connected';
                    document.getElementById('networkStatus').style.color = '#00ff88';
                    return true;
                } else {
                    throw new Error('Invalid response format');
                }
            } catch (error) {
                console.error('Error fetching epoch data:', error);
                document.getElementById('networkStatus').textContent = 'Error';
                document.getElementById('networkStatus').style.color = '#ff6b6b';
                return false;
            }
        }

        // Fetch automation fee estimate
        async function fetchAutomationFee() {
            try {
                const response = await fetch('https://rpc-testnet.supra.com/rpc/v2/view', {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        "function": "0x1::automation_registry::estimate_automation_fee",
                        "type_arguments": [],
                        "arguments": ["50000"]
                    })
                });
                
                const data = await response.json();
                if (data.result && data.result[0]) {
                    return parseInt(data.result[0]);
                } else {
                    throw new Error('Invalid fee response');
                }
            } catch (error) {
                console.error('Error fetching automation fee:', error);
                return 1440000000; // Default fallback
            }
        }

        // Calculate time remaining to next epoch
        function calculateTimeToNextEpoch() {
            if (!nextEpochTime) return null;

            const now = Math.floor(Date.now() / 1000); // Current time in seconds
            const timeLeft = nextEpochTime - now;
            
            return Math.max(0, timeLeft); // Don't return negative time
        }

        // Calculate expiry time (next epoch + buffer)
        function calculateExpiryTime() {
            if (!nextEpochTime) return null;
            return nextEpochTime + epochData.buffer;
        }

         function formatDuration(seconds) {
            if (seconds <= 0) return "Epoch ended";
            
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            if (hours > 0) {
                return `${hours}h ${minutes}m ${secs}s`;
            } else if (minutes > 0) {
                return `${minutes}m ${secs}s`;
            } else {
                return `${secs}s`;
            }
        }

        // Update countdown timer
        function updateCountdown() {
            const timeLeft = calculateTimeToNextEpoch();
            if (timeLeft !== null) {
                document.getElementById('timeToNext').textContent = formatDuration(timeLeft);
                
                // If epoch ended, refresh epoch data
                if (timeLeft <= 0) {
                    console.log('Epoch ended, refreshing data...');
                    updateDisplay();
                }
            }
        }

        // Update all display values
        async function updateDisplay() {
            console.log('Updating display...');
            
             const epochSuccess = await fetchEpochData();
            if (!epochSuccess) return;

            const automationFee = await fetchAutomationFee();
            
            // Calculate values
            const expiryTime = calculateExpiryTime();
            
            // Display fee
            const feeInSupra = (automationFee / 1000000).toFixed(2);
            document.getElementById('estimatedFee').textContent = `${feeInSupra} SUPRA`;
            
             document.getElementById('expiryTimeValue').textContent = expiryTime || 'Error';
            document.getElementById('feeCapValue').textContent = automationFee;
            
            // Generate CLI template
            const cliTemplate = `supra move automation register \\
  --task-max-gas-amount 50000 \\
  --task-gas-price-cap 200 \\
  --task-expiry-time-secs ${expiryTime} \\
  --task-automation-fee-cap ${automationFee} \\
  --function-id "YOUR_ADDRESS::MODULE::FUNCTION" \\
  --rpc-url https://rpc-testnet.supra.com`;
            
            document.getElementById('cliTemplate').textContent = cliTemplate;
            
            console.log('Display updated successfully');
        }

         async function copyToClipboard(elementId, button) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            try {
                await navigator.clipboard.writeText(text);
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.classList.add('success');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('success');
                }, 2000);
            } catch (err) {
                console.error('Failed to copy:', err);
                button.textContent = 'Error';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            }
        }

        // Initialize the application
        function init() {
            console.log('Initializing Supra Calculator...');
            createFloatingLetters();
            createParticleSystem();
            updateDisplay();
            
             updateInterval = setInterval(updateDisplay, 5000);
            
             countdownInterval = setInterval(updateCountdown, 1000);
        }

         window.addEventListener('beforeunload', () => {
            if (updateInterval) clearInterval(updateInterval);
            if (countdownInterval) clearInterval(countdownInterval);
        });

         window.addEventListener('load', init);

        // Automation Wizard State
        let wizardState = {
            walletConnected: false,
            walletAddress: '',
            selectedModule: '',
            selectedFunction: '',
            moduleABI: null,
            functionParams: []
        };
        // Helper function to get Starkey provider
        function getStarkeyProvider() {
            if ('starkey' in window) {
                const provider = window.starkey?.supra;
                if (provider) {
                    return provider;
                }
            }
            return null;
        }
        // Automation Wizard Functions
        async function connectStarkeyWallet() {
            try {
                // Check if Starkey wallet is available
                const provider = getStarkeyProvider();
                
                if (!provider) {
                    // Redirect to Starkey installation if not found
                    showNotification('Starkey wallet not found. Redirecting to installation...', 'info');
                    window.open('https://starkey.app/', '_blank');
                    throw new Error('Starkey wallet not found. Please install Starkey extension.');
                }
                
                // Connect to wallet
                showNotification('Connecting to Starkey wallet...', 'info');
                const accounts = await provider.connect();
                
                if (accounts && accounts.length > 0) {
                    const address = accounts[0];
                    wizardState.walletConnected = true;
                    wizardState.walletAddress = address;
                    
                    document.getElementById('walletAddress').textContent = `${address.slice(0, 6)}...${address.slice(-4)}`;
                    document.getElementById('walletStatus').style.display = 'block';
                    document.getElementById('connectWallet').style.display = 'none';
                    
                    // Automatically scan for modules at this wallet address
                    document.getElementById('autoScanStatus').style.display = 'block';
                    document.getElementById('autoScanStatus').innerHTML = '🔍 Scanning for modules at your wallet address...';
                    
                    // Auto-scan modules at wallet address
                    setTimeout(() => {
                        autoScanWalletModules(address);
                    }, 1000);
                    
                    showNotification('Wallet connected! Scanning for your modules...', 'success');
                    
                    // Listen for account changes
                    provider.on('accountChanged', (newAccounts) => {
                        if (newAccounts.length > 0) {
                            wizardState.walletAddress = newAccounts[0];
                            document.getElementById('walletAddress').textContent = `${newAccounts[0].slice(0, 6)}...${newAccounts[0].slice(-4)}`;
                            showNotification(`Switched to account ${newAccounts[0].slice(0, 6)}...${newAccounts[0].slice(-4)}`, 'info');
                            
                            // Re-scan modules for new address
                            autoScanWalletModules(newAccounts[0]);
                        }
                    });
                    
                    return true;
                } else {
                    throw new Error('No accounts returned from Starkey wallet');
                }
            } catch (error) {
                console.error('Wallet connection error:', error);
                
                // Show specific error message
                if (error.code === 4001) {
                    showNotification('Connection rejected by user', 'error');
                } else {
                    showNotification(`Connection failed: ${error.message}`, 'error');
                }
                
                // For demo purposes, simulate connection after error
                setTimeout(() => {
                    wizardState.walletConnected = true;
                    wizardState.walletAddress = '0x1c5acf62be507c27a7788a661b546224d806246765ff2695efece60194c6df05';
                    
                    document.getElementById('walletAddress').textContent = '0x1c5a...6df05 (Demo Mode)';
                    document.getElementById('walletStatus').style.display = 'block';
                    document.getElementById('connectWallet').style.display = 'none';
                    
                    // Auto-scan demo modules
                    document.getElementById('autoScanStatus').style.display = 'block';
                    document.getElementById('autoScanStatus').innerHTML = '🔍 Demo mode - loading example modules...';
                    
                    setTimeout(() => {
                        autoScanWalletModules(wizardState.walletAddress);
                    }, 1000);
                    
                    showNotification('Demo mode activated - Using example wallet with modules', 'info');
                }, 2000);
                
                return false;
            }
        }
        async function autoScanWalletModules(walletAddress) {
            try {
                document.getElementById('autoScanStatus').innerHTML = '🔍 Fetching modules from your wallet...';
                
                const response = await fetch(`https://rpc-testnet.supra.com/rpc/v2/accounts/${walletAddress}/modules`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Auto-scan API response:', data);
                
                let modules = [];
                
                // Handle the API response format
                if (data && data.modules && Array.isArray(data.modules)) {
                    modules = data.modules.map((module, index) => {
                        let moduleName = `Module_${index + 1}`;
                        
                        if (typeof module === 'string') {
                            moduleName = module;
                        } else if (module && typeof module === 'object') {
                            moduleName = module.name || 
                                        module.module_name || 
                                        module.module || 
                                        module.address?.split('::').pop() ||
                                        (module.abi && module.abi.name) ||
                                        `Module_${index + 1}`;
                        }
                        
                        return {
                            name: moduleName,
                            bytecode: 'Available',
                            abi: module.abi || module,
                            raw: module
                        };
                    });
                } else if (Array.isArray(data)) {
                    modules = data.map((module, index) => ({
                        name: module.name || module.module_name || `Module_${index + 1}`,
                        bytecode: 'Available',
                        abi: module.abi || module,
                        raw: module
                    }));
                }
                
                // Filter valid modules
                const validModules = modules.filter(module => 
                    module.name !== 'Unknown' && 
                    module.name !== 'modules' && 
                    module.name !== 'cursor' &&
                    module.name.length > 1
                );
                
                if (validModules.length > 0) {
                    document.getElementById('autoScanStatus').innerHTML = `✅ Found ${validModules.length} modules in your wallet!`;
                    displayModules(validModules, walletAddress);
                    enableStep(2); // Now step 2 is Select Module
                    showNotification(`Found ${validModules.length} modules at your wallet address!`, 'success');
                } else {
                    throw new Error('No modules found at wallet address');
                }
                
            } catch (error) {
                console.error('Auto-scan error:', error);
                
                // Fallback to known modules for demo
                document.getElementById('autoScanStatus').innerHTML = '⚠️ API scan failed - loading demo modules...';
                
                const demoModules = [
                    { name: 'auto_incr', bytecode: 'Available' },
                    { name: 'auto_counter', bytecode: 'Available' },
                    { name: 'auto_topup', bytecode: 'Available' },
                    { name: 'dice_roll', bytecode: 'Available' },
                    { name: 'HelloWorld', bytecode: 'Available' },
                    { name: 'SupraAI', bytecode: 'Available' },
                    { name: 'Counter', bytecode: 'Available' },
                    { name: 'auto_faucet', bytecode: 'Available' },
                    { name: 'SpinTheWheel', bytecode: 'Available' },
                    { name: 'auto_count', bytecode: 'Available' }
                ];
                
                displayModules(demoModules, walletAddress);
                enableStep(2);
                showNotification('Demo modules loaded from example wallet', 'info');
            }
        }
        function displayModules(modules, baseAddress) {
            const modulesList = document.getElementById('modulesList');
            modulesList.innerHTML = '';
            modules.forEach(module => {
                const moduleCard = document.createElement('div');
                moduleCard.className = 'module-card';
                moduleCard.innerHTML = `
                    <div class="module-name">${module.name}</div>
                    <div class="module-desc">Click to explore functions</div>
                `;
                
                moduleCard.addEventListener('click', (event) => selectModule(module.name, baseAddress, event));
                modulesList.appendChild(moduleCard);
            });
        }
        async function selectModule(moduleName, baseAddress, event) {
            // Update UI selection
            document.querySelectorAll('.module-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            wizardState.selectedModule = moduleName;
            
            document.getElementById('abiLoading').style.display = 'flex';
            
            try {
                // Try to get specific module ABI
                let response;
                let data;
                
                // First try the standard endpoint
                try {
                    response = await fetch(`https://rpc-testnet.supra.com/rpc/v2/accounts/${baseAddress}/modules/${moduleName}`);
                    if (response.ok) {
                        data = await response.json();
                        console.log('Module ABI response:', data);
                    }
                } catch (err) {
                    console.log('Standard endpoint failed, trying alternative...');
                }
                
                // If that fails, try getting all modules and find the one we want
                if (!data || !response?.ok) {
                    console.log('Trying to get module from all modules list...');
                    response = await fetch(`https://rpc-testnet.supra.com/rpc/v2/accounts/${baseAddress}/modules`);
                    if (response.ok) {
                        const allModules = await response.json();
                        console.log('All modules for finding specific:', allModules);
                        
                        // Try to find our module in the list
                        if (Array.isArray(allModules)) {
                            data = allModules.find(module => {
                                return module.name === moduleName || 
                                       (module.abi && module.abi.name === moduleName) ||
                                       (typeof module === 'object' && Object.keys(module).includes(moduleName));
                            });
                        }
                    }
                }
                
                let moduleABI = null;
                
                // Handle different possible ABI response formats
                if (data) {
                    if (data.abi) {
                        moduleABI = data.abi;
                    } else if (data.module && data.module.abi) {
                        moduleABI = data.module.abi;
                    } else if (data.exposed_functions) {
                        // Sometimes the ABI is directly in the response
                        moduleABI = data;
                    } else if (typeof data === 'object') {
                        // The data itself might be the ABI
                        moduleABI = data;
                    }
                }
                
                if (moduleABI) {
                    wizardState.moduleABI = moduleABI;
                    const entryFunctions = extractEntryFunctions(moduleABI);
                    if (entryFunctions.length > 0) {
                        displayFunctions(entryFunctions);
                        enableStep(3);
                        showNotification(`Found ${entryFunctions.length} entry functions!`, 'success');
                        return; // Success, exit here
                    } else {
                        console.log('No entry functions found, showing demo functions');
                    }
                } else {
                    console.log('No ABI found, showing demo functions');
                }
                
                // Fallback to demo functions if real ones aren't found
                throw new Error('Could not load real functions from module');
                
            } catch (error) {
                console.error('ABI fetch error:', error);
                
                // Demo functions based on the selected module name
                let demoFunctions = [];
                
                switch(moduleName.toLowerCase()) {
                    case 'auto_incr':
                    case 'auto_counter':
                    case 'counter':
                        demoFunctions = [
                            { name: 'auto_increment', params: [{ name: 'account', type: '&signer' }] },
                            { name: 'manual_increment', params: [{ name: 'account', type: '&signer' }] },
                            { name: 'reset_counter', params: [{ name: 'account', type: '&signer' }] }
                        ];
                        break;
                    case 'auto_topup':
                        demoFunctions = [
                            { name: 'auto_topup', params: [{ name: 'user', type: '&signer' }, { name: 'target', type: 'address' }, { name: 'threshold', type: 'u64' }, { name: 'amount', type: 'u64' }] },
                            { name: 'auto_withdraw', params: [{ name: 'user', type: '&signer' }, { name: 'target', type: 'address' }, { name: 'threshold', type: 'u64' }, { name: 'amount', type: 'u64' }] }
                        ];
                        break;
                    case 'dice_roll':
                        demoFunctions = [
                            { name: 'roll_dice', params: [{ name: 'sender', type: '&signer' }, { name: 'dice_range', type: 'u256' }] },
                            { name: 'resolve_dice_roll', params: [{ name: 'request_id', type: 'u64' }, { name: 'message', type: 'vector<u8>' }] }
                        ];
                        break;
                    case 'auto_faucet':
                        demoFunctions = [
                            { name: 'auto_claim', params: [{ name: 'user', type: '&signer' }] },
                            { name: 'auto_distribute', params: [{ name: 'admin', type: '&signer' }, { name: 'amount', type: 'u64' }] }
                        ];
                        break;
                    default:
                        demoFunctions = [
                            { name: 'auto_execute', params: [{ name: 'account', type: '&signer' }] },
                            { name: 'auto_harvest', params: [{ name: 'user', type: '&signer' }, { name: 'pool_id', type: 'u64' }] },
                            { name: 'auto_compound', params: [{ name: 'user', type: '&signer' }, { name: 'amount', type: 'u64' }] }
                        ];
                }
                
                displayFunctions(demoFunctions);
                enableStep(3);
                showNotification(`Loaded ${demoFunctions.length} demo functions for ${moduleName}`, 'info');
            } finally {
                document.getElementById('abiLoading').style.display = 'none';
            }
        }
        function extractEntryFunctions(abi) {
            // Parse ABI and extract entry functions
            try {
                let functions = [];
                
                // Handle different ABI formats
                if (abi.exposed_functions && Array.isArray(abi.exposed_functions)) {
                    // Standard format
                    functions = abi.exposed_functions;
                } else if (Array.isArray(abi)) {
                    // Direct array of functions
                    functions = abi;
                } else if (abi.functions && Array.isArray(abi.functions)) {
                    // Alternative format
                    functions = abi.functions;
                }
                
                return functions
                    .filter(func => {
                        // Check if function is entry function
                        return func.is_entry === true || 
                               func.visibility === 'public' ||
                               func.name?.includes('entry') ||
                               (func.modifiers && func.modifiers.includes('entry'));
                    })
                    .map(func => ({
                        name: func.name,
                        params: func.params || func.parameters || func.arguments || [],
                        visibility: func.visibility,
                        is_entry: func.is_entry
                    }));
            } catch (error) {
                console.error('ABI parsing error:', error);
                return [];
            }
        }
        function displayFunctions(functions) {
            const functionsList = document.getElementById('functionsList');
            functionsList.innerHTML = '';
            functions.forEach(func => {
                const functionCard = document.createElement('div');
                functionCard.className = 'function-card';
                functionCard.innerHTML = `
                    <div class="function-name">${func.name}</div>
                    <div class="function-desc">${func.params.length} parameters</div>
                `;
                
                // FIXED: Pass the event and element correctly
                functionCard.addEventListener('click', (event) => selectFunction(func, event));
                functionsList.appendChild(functionCard);
            });
        }
        function selectFunction(func, event) {
            // Update UI selection - FIXED: Now we have the event parameter
            document.querySelectorAll('.function-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            wizardState.selectedFunction = func.name;
            wizardState.functionParams = func.params;
            
            generateParameterInputs(func.params);
            updateAutomationParams();
            enableStep(4); // FIXED: Changed from enableStep(5) to enableStep(4)
        }
        function generateParameterInputs(params) {
            const container = document.getElementById('functionParams');
            container.innerHTML = '';
            params.forEach((param, index) => {
                if (param.type === '&signer') return; // Skip signer params
                
                const paramRow = document.createElement('div');
                paramRow.className = 'param-row';
                paramRow.innerHTML = `
                    <label>IF APPLICABLE</label>
                    <input type="text" 
                           class="param-input" 
                           data-param="${param.name}" 
                           data-param-type="${param.type}"
                           placeholder="Enter ${param.type} value">
                    <small>Type: ${param.type} - Enter the appropriate value for this parameter</small>
                `;
                container.appendChild(paramRow);
            });
        }
        function updateAutomationParams() {
            // Use the already calculated values from our existing tool
            const expiryTime = calculateExpiryTime();
            const automationFee = document.getElementById('feeCapValue').textContent;
            
            document.getElementById('expiryTimeAuto').value = expiryTime || 'Calculating...';
            document.getElementById('automationFeeAuto').value = automationFee || 'Calculating...';
            
            generateDeploymentSummary();
            enableStep(5); // Enable the final step
        }
        function generateDeploymentSummary() {
            const summary = document.getElementById('deploymentSummary');
            
            summary.innerHTML = `
                <div class="summary-item">
                    <div class="summary-label">Wallet Address</div>
                    <div class="summary-value">${wizardState.walletAddress.slice(0, 10)}...${wizardState.walletAddress.slice(-8)}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Module Name</div>
                    <div class="summary-value">${wizardState.selectedModule}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Function</div>
                    <div class="summary-value">${wizardState.selectedFunction}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Max Gas</div>
                    <div class="summary-value">${document.getElementById('maxGasAmount').value}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Gas Price Cap</div>
                    <div class="summary-value">${document.getElementById('gasPriceCap').value}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Expiry Time</div>
                    <div class="summary-value">${document.getElementById('expiryTimeAuto').value}</div>
                </div>
            `;
        }
        
        function generateCommand() {
            const deployStatus = document.getElementById('deployStatus');
            const generateBtn = document.getElementById('generateCommand');
            
            // Show generating status
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<div class="loading-spinner"></div><div class="btn-text">Generating...</div>';
            
            // Collect function arguments from form inputs
            const functionArgs = [];
            const paramInputs = document.querySelectorAll('#functionParams .param-input');
            paramInputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    const paramType = input.getAttribute('data-param-type');
                    functionArgs.push(`${paramType}:${value}`);
                }
            });
            
            // Build the CLI command
            const functionId = `${wizardState.walletAddress}::${wizardState.selectedModule}::${wizardState.selectedFunction}`;
            let cliCommand = `supra move automation register \\
  --task-max-gas-amount ${document.getElementById('maxGasAmount').value} \\
  --task-gas-price-cap ${document.getElementById('gasPriceCap').value} \\
  --task-expiry-time-secs ${document.getElementById('expiryTimeAuto').value} \\
  --task-automation-fee-cap ${document.getElementById('automationFeeAuto').value} \\
  --function-id "${functionId}" \\`;
            
            if (functionArgs.length > 0) {
                cliCommand += `
  --args ${functionArgs.join(' ')} \\`;
            }
            
            cliCommand += `
  --rpc-url https://rpc-testnet.supra.com`;
            
            // Simulate generation delay
            setTimeout(() => {
                deployStatus.style.display = 'block';
                deployStatus.className = 'deploy-status success';
                deployStatus.innerHTML = `
                    <h4>✅ CLI Command Generated!</h4>
                    <div style="background: rgba(53, 63, 74, 0.4); padding: 1rem; border-radius: 8px; margin: 1rem 0; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; white-space: pre-wrap; max-height: 200px; overflow-y: auto;">${cliCommand}</div>
                    <button onclick="copyToClipboard('deployStatus', this)" style="background: linear-gradient(135deg, #DD1438, #c41030); border: none; color: white; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 600;">Copy Command</button>
                `;
                
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<div class="btn-icon">📋</div><div class="btn-text">Generate CLI Command</div>';
                
                showNotification('CLI command generated successfully!', 'success');
            }, 1500);
        }
        
        function enableStep(stepNumber) {
            const step = document.getElementById(`step-${stepNumber}`);
            if (step) {
                step.classList.remove('disabled');
                step.classList.add('active');
                
                // Remove active class from previous steps
                for (let i = 1; i < stepNumber; i++) {
                    const prevStep = document.getElementById(`step-${i}`);
                    if (prevStep) {
                        prevStep.classList.remove('active');
                    }
                }
            }
        }
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <div class="notification-icon">
                        ${type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}
                    </div>
                    <div class="notification-message">${message}</div>
                </div>
            `;
            
            // Add notification styles
            notification.style.cssText = `
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: ${type === 'success' ? 'rgba(0, 255, 136, 0.1)' : type === 'error' ? 'rgba(255, 107, 107, 0.1)' : 'rgba(221, 20, 56, 0.1)'};
                border: 1px solid ${type === 'success' ? 'rgba(0, 255, 136, 0.3)' : type === 'error' ? 'rgba(255, 107, 107, 0.3)' : 'rgba(221, 20, 56, 0.3)'};
                color: ${type === 'success' ? '#00ff88' : type === 'error' ? '#ff6b6b' : '#DD1438'};
                padding: 1rem;
                border-radius: 8px;
                backdrop-filter: blur(20px);
                z-index: 1000;
                max-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Connect Wallet
            document.getElementById('connectWallet').addEventListener('click', connectStarkeyWallet);
            
            // Generate CLI Command
            document.getElementById('generateCommand').addEventListener('click', generateCommand);
            
            // Auto-update automation parameters when main values change
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.target.id === 'expiryTimeValue' || mutation.target.id === 'feeCapValue') {
                        if (wizardState.selectedFunction) {
                            updateAutomationParams();
                        }
                    }
                });
            });
            
            observer.observe(document.getElementById('expiryTimeValue'), { childList: true, characterData: true, subtree: true });
            observer.observe(document.getElementById('feeCapValue'), { childList: true, characterData: true, subtree: true });
            
            // Enable first step
            enableStep(1);
        });

    </script>
</body>
</html> '